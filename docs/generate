#!/usr/bin/env bash

SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
pushd $SCRIPT_DIR > /dev/null
jsduck \
    --config=./jsduck-config.json \
    -- \
        `find ../resources/{multilightbox,mmv} -name '*.js'` \
    2>&1 | tee jsduck.log \
    && echo "JSDuck execution finished."
RESULT=$?

if [ $RESULT -eq 0 ]; then
	grep "^Warning:" jsduck.log > /dev/null
	GREPPED=$?
	if [ $GREPPED -eq 0 ]; then
		RESULT=1
	fi
fi

popd > /dev/null

exit $RESULT
